#도커, 컨테이너 빌드업!

[이론]

- vm과 docker차이  
  => vm은 우리가 사용하는 운영체제 위에 아예 새로운 운영체제를 설치  
  => 도커는 우리가 사용하는 운영체제 위에 새로운 운영체제를 설치 시 공유되는 부분은 사용하고 나머지 없는 부분만 일부 탑재하는 것이다.

[명령어]

- -d 옵션  
  => 백그라운드에 컨테이너 실행 ex) run -itd OR run -it -d
- apt-get install -y "패키지"  
  => -y옵션은 설치 시 나타나는 모든 물음에 yes를 허용하겠다는 옵션

[dockerfile]

- 서버 구성 복제 방법

1. 컨테이너 생성 및 실행 후 내부에서 직접 환경 구성을 해서 이미지 생성(167p)  
   컨테이너 생성 => A컨테이너를 베이스 이미지로 활용 => A이미지로 run it 해서 컨테이너 생성(167p) => 단, 컨테이너 생성 시 자동으로 서비스 시작 되지 않음 => dockefile을 만들어서 A이미지를 넣으면 컨테이너 생성 시 서비스 자동 시작 됨(번거로움)
2. dockerfile에 담아서 생성

- Dockerfile에 작성한 명령을 순서대로 읽는다.
- dockerfile은 사용자의 개입이 없는(사용자와의 대화식 처리가 아닌) 자동화된 빌드이다. => 패키지 설치 시 반드시 -y 옵션을 사용해야한다.

- Buildkit

1. Buildkit를 추가하면 도커파일 이미지 빌드에 향상된 기능을 제공한다.
2. 특징  
   => 빌드 과정을 병렬 처리하여 더 빠른 빌드 제공  
   => 사용되지 않는 빌드 단계를 찾아서 비활성화  
   => 비밀번호 등의 민감한 데이터가 포함되는 경우 비밀 구축이 가능  
   => 빌드 중 빌드 정보에 따라 변경된 파일만 전송  
   => 자동 빌드 시 빌드 캐시의 우선순위를 정한다.
3. 사용 방법 DOCKER_BUILDKIT=1  
   => ex) DOCKER_BUILDKIT=1 docker build -t ~~~
